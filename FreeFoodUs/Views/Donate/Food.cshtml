@model dynamic
@{
    ViewBag.Title = "Donate";
}
<link href="~/css/font-awesome.css" rel="stylesheet" />
<h2>Donate Food</h2>
<table>
    <tr>
        <td><input style="width: 90px; display: initial" type="number" id="item_quantity" value="1" min="1" max="999" /></td>
        <td><input style="display: initial" class="typeahead" type="text" id="item_name" placeholder="Item name..." /></td>
        <td><input style="display: initial" type="button" id="add_item" disabled="disabled" value="Add" /></td>
    </tr>
</table>
<table id="items_container"></table>
<script type="text/javascript" src="~/Scripts/jquery-2.0.3.js"></script>
<script type="text/javascript" src="~/Scripts/typeahead.js"></script>
<script type="text/javascript" src="~/Scripts/hogan-2.0.0.js"></script>
<script type="text/javascript">

    function clearInput() {
        $("#item_name").val("");
        $("#item_quantity").val("1");
        $("#add_item").attr('disabled', 'disabled');
    }

    function removeItem() {
        $(this).parents("tr").remove();
    }

    function submit() {
        var $tpl = $($("#row-template").html());
        $tpl.find("td.first").append($("#item_quantity").val());
        $tpl.find("td.second").append($("#item_name").val());
        $tpl.find("td.third").append($("<i class='icon-remove-sign'></i>").click(removeItem));
        $("#items_container").append($tpl);
        clearInput();
    }

    $("#item_name").change(function () {
        if ($("#item_name").val().length === 0) {
            $("#add_item").attr('disabled', 'disabled');
        } else {
            $("#add_item").removeAttr('disabled');
        }
    });

    $(".remove-item").click(function () {
        $(this).remove();
    });


    $("#add_item").click(submit);

    var itemTemplate = $("#item-template").html();
    $('#item_name').typeahead({
        name: 'Food',
        prefetch: '../data/foods.js',
        //limit: 5,
        template: itemTemplate,
        engine: Hogan
    });

</script>
<script type="text/html" id="row-template">
    <tr>
        <td class="first"></td>
        <td class="second"></td>
        <td class="third"></td>
    </tr>
</script>
<script type="text/html" id="item-template">
    <div>
        <div>{{Group}}</div>
        <div>{{Food}}</div>
        <div>{{SubGroup}}</div>
    </div>
</script>
